[{"path":"https://matthewkling.github.io/spatialphy/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 spatialphy authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://matthewkling.github.io/spatialphy/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew Kling. Author, maintainer.","code":""},{"path":"https://matthewkling.github.io/spatialphy/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kling M (2022). spatialphy: Spatial Phylogenetic Analyses R. R package version 0.0.0.9000, https://matthewkling.github.io/spatialphy/.","code":"@Manual{,   title = {spatialphy: Spatial Phylogenetic Analyses in R},   author = {Matthew Kling},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://matthewkling.github.io/spatialphy/}, }"},{"path":"https://matthewkling.github.io/spatialphy/index.html","id":"spatialphy","dir":"","previous_headings":"","what":"Spatial Phylogenetic Analyses in R","title":"Spatial Phylogenetic Analyses in R","text":"spatialphy R package spatial phylogentic analysis. field spatial phylogenetics focuses accounting evolutionary relationships among taxa describing biodiversity patterns, approach number advantages species-based accounting. library currently includes functions computing: diversity measures like phylogenetic diversity turnover measures like phylogenetic betaendemism phylogenetic regionalization phylogenetic conservation prioritization WARNING: package still early stages development; may well bugs, API subject change. Use library real projects recommended stable version released.","code":""},{"path":"https://matthewkling.github.io/spatialphy/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Phylogenetic Analyses in R","text":"package yet CRAN. can install development version spatialphy like :","code":"# install.packages(\"remotes\") remotes::install_github(\"matthewkling/spatialphy\")"},{"path":"https://matthewkling.github.io/spatialphy/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Spatial Phylogenetic Analyses in R","text":"Spatial phylogenetic analyses require two essential ingredients: data geographic distributions set organisms, phylogeny representing evolutionary relationships. workflows spatialphy package involve creating dataset class 'spatialphy' containing necessary components. user normally define object data using sphy() function, can also simulate demonstration dataset using sphy_simulate(), ’ll . dataset list containing: phylogeny matrix occurrence data every clade every level tree (constructed internally user-supplied data occurrences terminal taxa). Note can presence-absence data, can fractional value indicating occurrence probability, often produced species distribution models. spatial metadata, form raster layer","code":"library(spatialphy) library(tmap); library(magrittr) set.seed(123) sp <- sphy_simulate(n_tips = 50)"},{"path":"https://matthewkling.github.io/spatialphy/index.html","id":"alpha-diversity","dir":"","previous_headings":"Examples","what":"Alpha diversity","title":"Spatial Phylogenetic Analyses in R","text":"can pass data object functions library. sphy_diversity() function calculates number alpha diversity measures, including phylogenetic diversity (PD), phylogenetic endemism (PE), several others.","code":"div <- sphy_diversity(sp) names(div) #>  [1] \"TR\"  \"CR\"  \"PD\"  \"TE\"  \"CE\"  \"PE\"  \"Em\"  \"PDm\" \"PEm\" \"BEm\" tm_shape(div$PD) + tm_raster()"},{"path":"https://matthewkling.github.io/spatialphy/index.html","id":"beta-diversity-turnover","dir":"","previous_headings":"Examples","what":"Beta diversity (turnover)","title":"Spatial Phylogenetic Analyses in R","text":"can also look patterns phylogenetic similarity among locations. first step compute community phylogenetic distance every pair sites; ’ll use sphy_dist() function add pariwise distance matrix additional component spatialphy dataset. done , can assess spatial turnover patterns couple ways. can qualitatively visualize converting distance matrix set colors representing similar two sites , using sphy_rgb() function:  can also perform formal cluster analysis splits landscape set evolutionary bioregions, using sphy_regions() function. ’ll ask eight regions:","code":"sp <- sphy_dist(sp, add = T) sp %>%       sphy_rgb() %>%       tm_shape() +       tm_rgb(max.value = 1) +       tm_layout(title = \"Phylogenetic ordination\") sp %>%       sphy_regions(k = 8) %>%       tm_shape() +       tm_raster(palette = \"cat\") +       tm_layout(legend.outside = T,                 title = \"Phylogenetic regions\")"},{"path":"https://matthewkling.github.io/spatialphy/index.html","id":"conservation-prioritization","dir":"","previous_headings":"Examples","what":"Conservation prioritization","title":"Spatial Phylogenetic Analyses in R","text":"Finally, package can also perform basic spatial conservation prioritization, identifying priority locations creation new protected areas order maximize biodiversity protection. done using sphy_prioritize() function, uses greedy forward stepwise algorithm produce nested ranking conservation priorities. addition spatial phylogenetic dataset, option supply raster layer indicating locations effectiveness existing protected areas. also modify parameters specify effective level protection provided new reserves, well shape “benefit” function determines relative importance protecting initial populations every taxon versus populations phylogenetically distinct taxa. ’ll stick defaults. map , highest-priority sites yellow.","code":"sp %>%       sphy_prioritize() %>%       tm_shape() +        tm_raster(palette = c(\"yellow\", \"red\", \"blue\", \"black\"),                 colorNA = \"gray80\", n = 20,                 title = \"conservation priorities\") +        tm_layout(legend.outside = T)"},{"path":"https://matthewkling.github.io/spatialphy/reference/benefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate taxon conservation benefit — benefit","title":"Calculate taxon conservation benefit — benefit","text":"Nonlinear functions convert proportion range conserved conservation \"benefit.\"","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/benefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate taxon conservation benefit — benefit","text":"","code":"benefit(x, lambda = 1)"},{"path":"https://matthewkling.github.io/spatialphy/reference/benefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate taxon conservation benefit — benefit","text":"x Fraction taxon range protected (value 0 1). lambda Shape parameter.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/benefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate taxon conservation benefit — benefit","text":"Value 0 1.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/beta_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"Compute pairwise community phylogenetic similarity matrix","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/beta_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"","code":"beta_diversity(M, branch_lengths)"},{"path":"https://matthewkling.github.io/spatialphy/reference/beta_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"M Site--taxon matrix. branch_lengths Vector branch lenghts taxon.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/beta_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"Pairwise matrix sorensen similarity sites","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/build_tree_ranges.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive ranges for the internal nodes of a tree — build_tree_ranges","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"Derive ranges internal nodes tree","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/build_tree_ranges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"","code":"build_tree_ranges(tree, tip_occs)"},{"path":"https://matthewkling.github.io/spatialphy/reference/build_tree_ranges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"tree Phylogeny (object class \"phylo\"). tip_occs Site--taxon matrix occurrences terminal taxa.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/build_tree_ranges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"site--taxon matrix column every branch, including terminals internal edges.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a spatial phylogeny object — sphy","title":"Create a spatial phylogeny object — sphy","text":"Create spatial phylogeny object","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a spatial phylogeny object — sphy","text":"","code":"sphy(tree, occ, spatial = NULL)"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a spatial phylogeny object — sphy","text":"tree Phylogeny class \"phylo\". occ Occurrence data across taxa sites. Can matrix column per taxon row per site, RasterBrick/RasterStack layer per taxon. must either one taxon per edge tree, one taxon per tip. spatial optional raster layer indicating site locations. Ignored occ raster object.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a spatial phylogeny object — sphy","text":"\"spatialphy\" object","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a phyologenetic turnover matrix — sphy_dist","title":"Compute a phyologenetic turnover matrix — sphy_dist","text":"Compute phyologenetic turnover matrix","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a phyologenetic turnover matrix — sphy_dist","text":"","code":"sphy_dist(sp, add = T)"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a phyologenetic turnover matrix — sphy_dist","text":"sp spatialphy object. add results added spatialphy object returned (T) returned alone (F)?","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a phyologenetic turnover matrix — sphy_dist","text":"pairwise phylogenetic difference matrix, values 1/PhyloSor, either element sp.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate spatial phyologenetic diversity metrics — sphy_diversity","title":"Calculate spatial phyologenetic diversity metrics — sphy_diversity","text":"Calculate spatial phyologenetic diversity metrics","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate spatial phyologenetic diversity metrics — sphy_diversity","text":"","code":"sphy_diversity(sp, spatial = T)"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate spatial phyologenetic diversity metrics — sphy_diversity","text":"sp spatialphy object (created sphy() simulate_sphy()). spatial Boolean: function return spatial object (TRUE, default) vector (FALSE).","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate spatial phyologenetic diversity metrics — sphy_diversity","text":"matrix raster stack column layer (respectively) diversity metric.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_diversity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate spatial phyologenetic diversity metrics — sphy_diversity","text":"function calculates following metrics: TR: Terminal richness, .e. richness terminal taxa (many cases species) CR: Clade richness, .e. richness taxa levels PD: Phylogenetic diversity TE: Terminal endemism, .e. total endemic diversity terminal taxa, aka CE: Clade endemism, .e. total endemic diversity taxa levels PE: Phylogenetic endemism Em: Mean endemism (derivation equivalent E / CR) PDm: Mean phylogenetic diversity, .e. branch length mean resident (derivation equivalent PD / CR) PEm: Mean phylogenetic endemism, .e. branch length / range size mean resident (derivation equivalent PE / CR BEm: Mean branch length endemics","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_prioritize.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic conservation prioritization — sphy_prioritize","title":"Phylogenetic conservation prioritization — sphy_prioritize","text":"Create ranking conservation priorities using greedy forward stepwise optimization. ","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_prioritize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic conservation prioritization — sphy_prioritize","text":"","code":"sphy_prioritize(sp, protection = NULL, lambda = 1, level = 1)"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_prioritize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phylogenetic conservation prioritization — sphy_prioritize","text":"sp spatialphy object. protection Starting protection status, either raster vector, values 0 1 representing conservation effectiveness. argument supplied, assumed existing reserves present. lambda Shape parameter taxon conservation benefit function. level Effectiveness level proposed new reserves (number 0 1, meaning starting protection).","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_prioritize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phylogenetic conservation prioritization — sphy_prioritize","text":"ranking conservation priorities, low values representing higher priorities.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rand.html","id":null,"dir":"Reference","previous_headings":"","what":"Randomization tests including CANAPE — sphy_rand","title":"Randomization tests including CANAPE — sphy_rand","text":"function wrapper around cpr_rand_test function Joel Nitta's canaper package.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Randomization tests including CANAPE — sphy_rand","text":"","code":"sphy_rand(sp, null_model = \"swap\", spatial = T, ...)"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Randomization tests including CANAPE — sphy_rand","text":"sp spatialphy object null_model see canaper::cpr_rand_test spatial Boolean: function return spatial object (TRUE, default) vector (FALSE). ... arguments passed canaper::cpr_rand_test","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Randomization tests including CANAPE — sphy_rand","text":"matrix raster stack column layer (respectively) metric.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rand.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Randomization tests including CANAPE — sphy_rand","text":"function runs canaper::cpr_rand_test; see help function details. also runs canaper::cpr_classify_endem result, includes resulting classification additional variable, 'endem_type', output. 'endem_type' values 0-4 correspond -significant, neo, paleo, mixed, super endemesim, respectively.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Phyologenetic regionalization — sphy_regions","title":"Phyologenetic regionalization — sphy_regions","text":"Phyologenetic regionalization","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phyologenetic regionalization — sphy_regions","text":"","code":"sphy_regions(sp, k = 5, method = \"hclust\")"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phyologenetic regionalization — sphy_regions","text":"sp spatialphy object. k Number spatial clusters divide region (Positive integer). method Clustering method; currently \"hclust\" supported.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phyologenetic regionalization — sphy_regions","text":"raster matrix integer indicating k regions site belongs .","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rgb.html","id":null,"dir":"Reference","previous_headings":"","what":"Color space ordination of spatial phylogentic composition — sphy_rgb","title":"Color space ordination of spatial phylogentic composition — sphy_rgb","text":"Color space ordination spatial phylogentic composition","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rgb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Color space ordination of spatial phylogentic composition — sphy_rgb","text":"","code":"sphy_rgb(sp, ord_method = \"nmds\")"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rgb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Color space ordination of spatial phylogentic composition — sphy_rgb","text":"sp spatialphy object. ord_method Ordination method, either \"cmds\" (classical MDS) \"nmds\" (nonmetric MDS, slower often preferred)","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_rgb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Color space ordination of spatial phylogentic composition — sphy_rgb","text":"raster matrix layers columns (respectively) containing RGB color values.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_simulate.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a toy spatial phylogenetic dataset — sphy_simulate","title":"Simulate a toy spatial phylogenetic dataset — sphy_simulate","text":"Simulate toy spatial phylogenetic dataset","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_simulate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a toy spatial phylogenetic dataset — sphy_simulate","text":"","code":"sphy_simulate(n_tips = 10, n_x = 20, n_y = 20, boolean_ranges = F)"},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_simulate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a toy spatial phylogenetic dataset — sphy_simulate","text":"n_tips Number terminals phylogeny. n_x Number raster cells x dimension landscape. n_y Number raster cells y dimension landscape. boolean_ranges simulated ranges boolean (T) probabilities (F, default)?","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/sphy_simulate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a toy spatial phylogenetic dataset — sphy_simulate","text":"list containing phylogenetic tree raster stack terminal taxon ranges.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/to_raster.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a site-by-variable matrix into a raster brick — to_raster","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"Convert site--variable matrix raster brick","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/to_raster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"","code":"to_raster(m, template)"},{"path":"https://matthewkling.github.io/spatialphy/reference/to_raster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"m Matrix. template Raster layer, number cells equal number rows m.","code":""},{"path":"https://matthewkling.github.io/spatialphy/reference/to_raster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"raster brick.","code":""}]
