[{"path":"https://matthewkling.github.io/phylospatial/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 phylospatial authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://matthewkling.github.io/phylospatial/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew Kling. Author, maintainer.","code":""},{"path":"https://matthewkling.github.io/phylospatial/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kling M (2024). phylospatial: Spatial Phylogenetic Analyses R. R package version 0.0.0.9000, https://matthewkling.github.io/phylospatial/.","code":"@Manual{,   title = {phylospatial: Spatial Phylogenetic Analyses in R},   author = {Matthew Kling},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://matthewkling.github.io/phylospatial/}, }"},{"path":"https://matthewkling.github.io/phylospatial/index.html","id":"phylospatial","dir":"","previous_headings":"","what":"Spatial Phylogenetic Analyses in R","title":"Spatial Phylogenetic Analyses in R","text":"phylospatial R package spatial phylogentic analysis. field spatial phylogenetics focuses accounting evolutionary relationships among taxa describing biodiversity patterns, approach number advantages species-based accounting. library currently includes functions computing: diversity measures like phylogenetic diversity turnover measures like phylogenetic betaendemism phylogenetic regionalization phylogenetic conservation prioritization One feature differentiates phylospatial similar packages addition working binary presence/absence data, ’s also designed work continuous quantities occurrence probabilities abundances. quantities treated weights throughout analyses package, avoiding need discard information thresholding data.","code":""},{"path":"https://matthewkling.github.io/phylospatial/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Phylogenetic Analyses in R","text":"package yet CRAN. can install development version phylospatial like :","code":"# install.packages(\"remotes\") remotes::install_github(\"matthewkling/phylospatial\")"},{"path":"https://matthewkling.github.io/phylospatial/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Spatial Phylogenetic Analyses in R","text":"Spatial phylogenetic analyses require two essential ingredients: data geographic distributions set organisms, phylogeny representing evolutionary relationships. workflows phylospatial package involve creating data set class 'spatialphy' containing necessary components. user normally define object data using sphy() function, can also simulate demonstration dataset using ps_simulate(). get started, let’s load phylospatial library simulate demo data set. get peek underlying data, let’s plot geographic ranges terminal species:","code":"library(phylospatial) library(tmap); library(magrittr) set.seed(123) ps <- ps_simulate(n_tips = 20, n_x = 50, n_y = 50) tm_shape(get_tip_occs(ps, spatial = TRUE)) +        tm_raster(palette = \"inferno\", style = \"cont\", title = \"occurrence\\nprobability\")"},{"path":"https://matthewkling.github.io/phylospatial/index.html","id":"alpha-diversity","dir":"","previous_headings":"Examples","what":"Alpha diversity","title":"Spatial Phylogenetic Analyses in R","text":"can pass spatialphy object various functions library. ps_diversity() function calculates number alpha diversity measures, including phylogenetic diversity (PD) phylogenetic endemism (PE), among others. Let’s calculate diversity metrics make plot PD:  can also use randomization calculate significance diversity metrics null model, using ps_rand() function. default null model uses stratified randomization designed use continuous occurrence data. Let’s run 100 randomizations plot results PE. quantile value gives proportion randomizations observed PE greater randomized PE given grid cell (wanted identify “statistically significant” grid cells one-tailed test alpha = 0.05, cells values greater 0.95).","code":"div <- ps_diversity(ps) names(div) #>  [1] \"TR\"  \"CR\"  \"PD\"  \"TE\"  \"CE\"  \"PE\"  \"Em\"  \"RPD\" \"PEm\" \"RPE\" tm_shape(div$PD) + tm_raster(palette = \"inferno\", style = \"cont\") rand <- ps_rand(ps, n_rand = 100) #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100% tm_shape(rand$qPE) + tm_raster(palette = \"inferno\", style = \"cont\")"},{"path":"https://matthewkling.github.io/phylospatial/index.html","id":"beta-diversity-turnover","dir":"","previous_headings":"Examples","what":"Beta diversity (turnover)","title":"Spatial Phylogenetic Analyses in R","text":"can also look patterns phylogenetic similarity among locations. first step compute community phylogenetic distance every pair sites, using ps_dist() function add pairwise distance matrix additional component spatial phylogenetic dataset. done , can assess spatial turnover patterns couple ways. can qualitatively visualize compositional differences converting distance matrix set colors representing similar two sites , using ps_rgb() function:  can also perform formal cluster analysis splits landscape set evolutionary bioregions, using ps_regions() function. Let’s ask eight regions using “kmeans” clustering method:","code":"ps <- ps_dist(ps, add = TRUE) ps %>%       ps_rgb(method = \"cmds\") %>%       tm_shape() +       tm_rgb(max.value = 1) +       tm_layout(title = \"Phylogenetic ordination\") ps %>%       ps_regions(k = 8, method = \"kmeans\") %>%       tm_shape() +       tm_raster(style = \"cat\", palette = \"Dark2\",                 title = \"phylogenetic region\") +       tm_layout(legend.outside = T)"},{"path":"https://matthewkling.github.io/phylospatial/index.html","id":"conservation-prioritization","dir":"","previous_headings":"Examples","what":"Conservation prioritization","title":"Spatial Phylogenetic Analyses in R","text":"Finally, package can perform basic spatial conservation prioritization, identifying priority locations creation new protected areas order maximize biodiversity protection. done using ps_prioritize() function, uses greedy forward stepwise algorithm produce nested ranking conservation priorities. addition required spatial phylogenetic dataset, option supply raster layer indicating locations effectiveness existing protected areas. also modify parameters specify effective level protection provided new reserves, well shape “benefit” function determines relative importance protecting initial populations every taxon versus populations phylogenetically distinct taxa. example let’s stick defaults. map , highest-priority sites shown yellow.","code":"ps %>%       ps_prioritize() %>%       tm_shape() +        tm_raster(palette = \"-inferno\", style = \"log10\",                 title = \"conservation\\npriorities\") +        tm_layout(legend.outside = T) #>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%"},{"path":"https://matthewkling.github.io/phylospatial/reference/benefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate taxon conservation benefit — benefit","title":"Calculate taxon conservation benefit — benefit","text":"Nonlinear functions convert proportion range conserved conservation \"benefit.\"","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/benefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate taxon conservation benefit — benefit","text":"","code":"benefit(x, lambda = 1)"},{"path":"https://matthewkling.github.io/phylospatial/reference/benefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate taxon conservation benefit — benefit","text":"x Fraction taxon range protected (value 0 1). lambda Shape parameter.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/benefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate taxon conservation benefit — benefit","text":"Value 0 1.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/beta_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"Compute pairwise community phylogenetic similarity matrix","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/beta_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"","code":"beta_diversity(M, branch_lengths)"},{"path":"https://matthewkling.github.io/phylospatial/reference/beta_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"M Site--taxon matrix. branch_lengths Vector branch lenghts taxon.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/beta_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a pairwise community phylogenetic similarity matrix — beta_diversity","text":"Pairwise matrix sorensen similarity sites","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/build_tree_ranges.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive ranges for the internal nodes of a tree — build_tree_ranges","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"Derive ranges internal nodes tree","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/build_tree_ranges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"","code":"build_tree_ranges(tree, tip_occs)"},{"path":"https://matthewkling.github.io/phylospatial/reference/build_tree_ranges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"tree Phylogeny (object class \"phylo\"). tip_occs Site--taxon matrix occurrences terminal taxa.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/build_tree_ranges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive ranges for the internal nodes of a tree — build_tree_ranges","text":"site--taxon matrix column every branch, including terminals internal edges.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/get_tip_occs.html","id":null,"dir":"Reference","previous_headings":"","what":"Occurrence matrix for terminal taxa — get_tip_occs","title":"Occurrence matrix for terminal taxa — get_tip_occs","text":"community matrix contained spatialphy object includes column every terminal internal branch. function returns sub-matrix includes terminal taxa.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/get_tip_occs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occurrence matrix for terminal taxa — get_tip_occs","text":"","code":"get_tip_occs(sp, spatial = F)"},{"path":"https://matthewkling.github.io/phylospatial/reference/get_tip_occs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Occurrence matrix for terminal taxa — get_tip_occs","text":"sp Object class spatialphy.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/get_tip_occs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Occurrence matrix for terminal taxa — get_tip_occs","text":"site--taxon matrix column every terminal branch.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_canape.html","id":null,"dir":"Reference","previous_headings":"","what":"Binary randomization tests including CANAPE — ps_canape","title":"Binary randomization tests including CANAPE — ps_canape","text":"function wrapper around cpr_rand_test function Joel Nitta's canaper package. keeping CANAPE, requires binary community matrix uses hard significance threshold (alternative utilizes continuous occurrences values retains significance gradient, see ps_snape ps_rand).","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_canape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binary randomization tests including CANAPE — ps_canape","text":"","code":"ps_canape(sp, null_model = \"curveball\", spatial = T, ...)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_canape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binary randomization tests including CANAPE — ps_canape","text":"sp spatialphy object null_model see canaper::cpr_rand_test spatial Boolean: function return spatial object (TRUE, default) vector (FALSE). ... arguments passed canaper::cpr_rand_test","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_canape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Binary randomization tests including CANAPE — ps_canape","text":"matrix raster stack column layer (respectively) metric.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_canape.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binary randomization tests including CANAPE — ps_canape","text":"function runs canaper::cpr_rand_test; see help function details. also runs canaper::cpr_classify_endem result, includes resulting classification additional variable, 'endem_type', output. 'endem_type' values 0-4 correspond -significant, neo, paleo, mixed, super endemesim, respectively.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a phyologenetic turnover matrix — ps_dist","title":"Compute a phyologenetic turnover matrix — ps_dist","text":"Compute phyologenetic turnover matrix","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a phyologenetic turnover matrix — ps_dist","text":"","code":"ps_dist(sp, endemism = FALSE, normalize = TRUE, add = TRUE)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a phyologenetic turnover matrix — ps_dist","text":"sp spatialphy object. endemism Logical indicating whether occurrence values divided column (species) totals. normalize Logical indicating whether occurrence values divided row (community) totals. , happens endemism division. add Logical indicating whether results added spatialphy object returned (TRUE) returned alone (FALSE)?","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a phyologenetic turnover matrix — ps_dist","text":"pairwise phylogenetic difference matrix, values 1/PhyloSor, either element sp.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate spatial phylogenetic diversity and endemism metrics — ps_diversity","title":"Calculate spatial phylogenetic diversity and endemism metrics — ps_diversity","text":"Calculate spatial phylogenetic diversity endemism metrics","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate spatial phylogenetic diversity and endemism metrics — ps_diversity","text":"","code":"ps_diversity(sp, spatial = T)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate spatial phylogenetic diversity and endemism metrics — ps_diversity","text":"sp spatialphy object (created sphy() simulate_sphy()). spatial Boolean: function return spatial object (TRUE, default) vector (FALSE).","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate spatial phylogenetic diversity and endemism metrics — ps_diversity","text":"matrix raster stack column layer (respectively) diversity metric.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_diversity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate spatial phylogenetic diversity and endemism metrics — ps_diversity","text":"function calculates following metrics: TR: Terminal richness, .e. richness terminal taxa (many cases species) CR: Clade richness, .e. richness taxa levels (equivalent PD cladogram) PD: Phylogenetic diversity TE: Terminal endemism, .e. total endemism-weighted diversity terminal taxa (.k.. \"weighted endemism\") CE: Clade endemism, .e. total endemism-weighted diversity taxa levels (equivalent PE cladrogram) PE: Phylogenetic endemism, .e. endemism-weighted PD Em: Mean endemism (equivalent CE / CR) RPD: Relative phylogenetic diversity, .e. branch length mean resident (equivalent PD / CR) PEm: Mean phylogenetic endemism, .e. branch length / range size mean resident (equivalent PE / CR) RPE: Relative phylogenetic endemism, .e. mean endemism-weighted branch length (equivalent PE / CE)","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_prioritize.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic conservation prioritization — ps_prioritize","title":"Phylogenetic conservation prioritization — ps_prioritize","text":"Create ranking conservation priorities using greedy forward stepwise optimization. ","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_prioritize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic conservation prioritization — ps_prioritize","text":"","code":"ps_prioritize(sp, protection = NULL, lambda = 1, level = 1)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_prioritize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phylogenetic conservation prioritization — ps_prioritize","text":"sp spatialphy object. protection Starting protection status, either raster vector, values 0 1 representing conservation effectiveness. argument supplied, assumed existing reserves present. lambda Shape parameter taxon conservation benefit function. level Effectiveness level proposed new reserves (number 0 1, meaning starting protection).","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_prioritize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phylogenetic conservation prioritization — ps_prioritize","text":"ranking conservation priorities, low values representing higher priorities.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rand.html","id":null,"dir":"Reference","previous_headings":"","what":"Null model randomization analysis of alpha diversity metrics — ps_rand","title":"Null model randomization analysis of alpha diversity metrics — ps_rand","text":"function compares diversity metrics calculated ps_diversity null distributions computed randomizing community matrix. Randomization done using strand method community matrices containing continuous occurrence quantities occurrence probabilities abundances.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Null model randomization analysis of alpha diversity metrics — ps_rand","text":"","code":"ps_rand(sp, n_rand = 100, spatial = T, n_cores = 1, ...)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Null model randomization analysis of alpha diversity metrics — ps_rand","text":"sp spatialphy object. n_rand Integer giving number random communities generate. spatial Boolean: function return spatial object (TRUE, default) matix (FALSE). n_cores Integer giving number compute cores use parallel processing. ... Additional arguments passed strand, n_strata, jitter, transform, priority, etc.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Null model randomization analysis of alpha diversity metrics — ps_rand","text":"matrix row every row x, column every metric ps_diversity, values indicating proportion randomizations observed diversity metric greater randomized metric.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Phyologenetic regionalization — ps_regions","title":"Phyologenetic regionalization — ps_regions","text":"Phyologenetic regionalization","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phyologenetic regionalization — ps_regions","text":"","code":"ps_regions(sp, k = 5, method = \"kmeans\", endemism = FALSE, normalize = TRUE)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phyologenetic regionalization — ps_regions","text":"sp spatialphy object. k Number spatial clusters divide region (Positive integer). method Clustering method. Options include \"kmeans\", methods listed hclust. endemism Logical indicating whether occurrence values divided column (species) totals. normalize Logical indicating whether occurrence values divided row (community) totals. , happens endemism division.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phyologenetic regionalization — ps_regions","text":"raster matrix integer indicating k regions site belongs .","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rgb.html","id":null,"dir":"Reference","previous_headings":"","what":"Color space ordination of spatial phylogenetic composition — ps_rgb","title":"Color space ordination of spatial phylogenetic composition — ps_rgb","text":"Color space ordination spatial phylogenetic composition","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rgb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Color space ordination of spatial phylogenetic composition — ps_rgb","text":"","code":"ps_rgb(sp, method = \"nmds\", trans = identity)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rgb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Color space ordination of spatial phylogenetic composition — ps_rgb","text":"sp spatialphy object. method Ordination method, either \"pca\" (principal component analysis), \"cmds\" (classical MDS), \"nmds\" (nonmetric MDS, default, slower often preferred). trans function giving transformation apply dimension ordinated data. default identity funciton. Specifying rank generates uniform color distribution.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_rgb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Color space ordination of spatial phylogenetic composition — ps_rgb","text":"raster matrix layers columns (respectively) containing RGB color values range 0-1.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_simulate.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a toy spatial phylogenetic dataset — ps_simulate","title":"Simulate a toy spatial phylogenetic dataset — ps_simulate","text":"Simulate toy spatial phylogenetic dataset","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_simulate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a toy spatial phylogenetic dataset — ps_simulate","text":"","code":"ps_simulate(n_tips = 10, n_x = 20, n_y = 20, boolean_ranges = F)"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_simulate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a toy spatial phylogenetic dataset — ps_simulate","text":"n_tips Number terminals phylogeny. n_x Number raster cells x dimension landscape. n_y Number raster cells y dimension landscape. boolean_ranges simulated ranges boolean (T) probabilities (F, default)?","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_simulate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a toy spatial phylogenetic dataset — ps_simulate","text":"list containing phylogenetic tree raster stack terminal taxon ranges.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_snape.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth Neo- And Paleo-Endemism (SNAPE) analysis — ps_snape","title":"Smooth Neo- And Paleo-Endemism (SNAPE) analysis — ps_snape","text":"function implements SNAPE, analog CANAPE (Mishler et al. 2014) biodiversity datasets continuous occurrence values representing quantities like occurrence probabilities abundances.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_snape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth Neo- And Paleo-Endemism (SNAPE) analysis — ps_snape","text":"","code":"ps_snape(   rand,   palette = c(\"gray90\", \"blue\", \"red\"),   transform = function(x) x^2 )"},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_snape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth Neo- And Paleo-Endemism (SNAPE) analysis — ps_snape","text":"rand matrix RasterBrick randomization quantiles, generated ps_rand. palette character vector three colors, corresponding low endemism, high RPE, low RPE, respectively. transform function takes value 0 1 returns value 0 1. determines shape color gradient transitioning low high endemism.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_snape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth Neo- And Paleo-Endemism (SNAPE) analysis — ps_snape","text":"list containing two data frames. snape data frame row community rand, columns SNAPE color value well variables used compute ; variable taken directly rand qPCE, parallel maximum qPE qCE. legend data frame can used illustrate color scale; row gives color corresponding particular combination qPCE qRPE.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/ps_snape.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smooth Neo- And Paleo-Endemism (SNAPE) analysis — ps_snape","text":"CANAPE method (Mishler et al. 2014) identifies areas statistically significant concentrations neo- paleo-endemism. illuminating, CANAPE analysis requires binary-presence absence data necessitates thresholding continuous biodiversity data like occurrence probabilities abundances, requires hard statistical significance thresholds, steps ","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/sphy.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a spatial phylogeny object — sphy","title":"Create a spatial phylogeny object — sphy","text":"Create spatial phylogeny object","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/sphy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a spatial phylogeny object — sphy","text":"","code":"sphy(tree, occ, spatial = NULL)"},{"path":"https://matthewkling.github.io/phylospatial/reference/sphy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a spatial phylogeny object — sphy","text":"tree Phylogeny class \"phylo\". occ Occurrence data across taxa sites. Can matrix column per taxon row per site, RasterBrick/RasterStack layer per taxon. must either one taxon per edge tree, one taxon per tip. spatial optional raster layer indicating site locations. Ignored occ raster object.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/sphy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a spatial phylogeny object — sphy","text":"\"spatialphy\" object","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/strand.html","id":null,"dir":"Reference","previous_headings":"","what":"Stratified randomization of community matrix — strand","title":"Stratified randomization of community matrix — strand","text":"community null model method quantitative data (e.g. abundance occurrence probability) preserves row column totals, also approximately preserves marginal distributions rows columns. randomization, data set split strata representing numerical ranges input quantities, separate binary randomization done stratum, results combined produce randomized, quantitative community matrix. See vegan::commsim() details binary quantitative null models.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/strand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stratified randomization of community matrix — strand","text":"","code":"strand(   x,   n_strata = 5,   transform = identity,   algorithm = \"curveball\",   jitter = 0.99,   priority = \"neither\",   n_iter = 10000,   ... )"},{"path":"https://matthewkling.github.io/phylospatial/reference/strand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stratified randomization of community matrix — strand","text":"x Community matrix species rows, sites columns, nonnegative occurrence quantities cells. n_strata Integer giving number strata split data . Must 2 greater. Larger values result randomizations less mixing higher fidelity marginal distributions. transform function used transform values x assigning n_strata equal intervals. Examples include sqrt, log, rank, etc.; default identity. algorithm Null model algorithm, passed vegan::nullmodel. Testing done \"curveball\" algorithm, options use caution. binary methods used. jitter Number 0 1, indicating much randomly jitter location stratum boundaries. priority Either \"rows\", \"cols\", \"neither\", indicating whether randomization within strata prioritize maintaining marginal distributions rows columns input matrix. default, \"neither\", give precedence either dimension. n_iter Positive integer giving number iterations use stepwise algorithms.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/strand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stratified randomization of community matrix — strand","text":"randomized version x.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/to_raster.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a site-by-variable matrix into a raster brick — to_raster","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"Convert site--variable matrix raster brick","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/to_raster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"","code":"to_raster(m, template)"},{"path":"https://matthewkling.github.io/phylospatial/reference/to_raster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"m Matrix. template Raster layer, number cells equal number rows m.","code":""},{"path":"https://matthewkling.github.io/phylospatial/reference/to_raster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a site-by-variable matrix into a raster brick — to_raster","text":"raster brick.","code":""}]
