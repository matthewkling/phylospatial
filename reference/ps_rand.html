<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Null model randomization analysis of alpha diversity metrics — ps_rand • phylospatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Null model randomization analysis of alpha diversity metrics — ps_rand"><meta name="description" content="This function compares phylodiversity metrics calculated in ps_diversity to their null distributions
computed by randomizing the community matrix or shuffling the tips of the phylogeny, indicating statistical
significance under the assumptions of the null model. Various null model algorithms are available for
binary, probability, and count data."><meta property="og:description" content="This function compares phylodiversity metrics calculated in ps_diversity to their null distributions
computed by randomizing the community matrix or shuffling the tips of the phylogeny, indicating statistical
significance under the assumptions of the null model. Various null model algorithms are available for
binary, probability, and count data."><meta property="og:image" content="https://matthewkling.github.io/phylospatial/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phylospatial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phylospatial-data.html">Spatial phylogentic data</a></li>
    <li><a class="dropdown-item" href="../articles/alpha-diversity.html">Alpha phylogenetic diversity</a></li>
    <li><a class="dropdown-item" href="../articles/beta-diversity.html">Phylogenetic beta diversity</a></li>
    <li><a class="dropdown-item" href="../articles/prioritization.html">Conservation prioritization</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/matthewkling/phylospatial/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Null model randomization analysis of alpha diversity metrics</h1>
      <small class="dont-index">Source: <a href="https://github.com/matthewkling/phylospatial/blob/v1.1.1/R/ps_rand.R" class="external-link"><code>R/ps_rand.R</code></a></small>
      <div class="d-none name"><code>ps_rand.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function compares phylodiversity metrics calculated in <a href="ps_diversity.html">ps_diversity</a> to their null distributions
computed by randomizing the community matrix or shuffling the tips of the phylogeny, indicating statistical
significance under the assumptions of the null model. Various null model algorithms are available for
binary, probability, and count data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ps_rand</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PD"</span>, <span class="st">"PE"</span>, <span class="st">"RPE"</span>, <span class="st">"CE"</span><span class="op">)</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"quantize"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"curveball"</span>,</span>
<span>  n_rand <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  summary <span class="op">=</span> <span class="st">"quantile"</span>,</span>
<span>  spatial <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  progress <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p><code>phylospatial</code> object.</p></dd>


<dt id="arg-metric">metric<a class="anchor" aria-label="anchor" href="#arg-metric"></a></dt>
<dd><p>Character vector giving one or more diversity metrics to calculate; see <a href="ps_diversity.html">ps_diversity</a>
for options. Can also specify <code>"all"</code> to calculate all available metrics.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Null model function to use. Must be either "tip_shuffle", "nullmodel", "quantize", or an actual function:</p><ul><li><p>"tip_shuffle": randomly shuffles the identities of terminal taxa</p></li>
<li><p>"nullmodel": uses <a href="https://rdrr.io/pkg/vegan/man/nullmodel.html" class="external-link">nullmodel</a> and <a href="https://rdrr.io/pkg/vegan/man/nullmodel.html" class="external-link">simulate.nullmodel</a>, from the vegan
package, which offer a wide range of randomization algorithms with different properties.</p></li>
<li><p>"quantize": (the default) deploys the function <a href="quantize.html">quantize</a>, a routine that is itself
a wrapper around <a href="https://rdrr.io/pkg/vegan/man/nullmodel.html" class="external-link">nullmodel</a>, allowing the use of binary algorithms for quantitative data.</p></li>
<li><p>Any other function that accepts a community matrix as its first argument and returns a
randomized version of the matrix.</p></li>
</ul></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>One of the method options listed under <a href="https://rdrr.io/pkg/vegan/man/commsim.html" class="external-link">commsim</a>. If <code>fun = "quantize"</code>, this must
be one of the "binary" methods. If <code>fun = "nullmodel"</code>, be sure to select a method that is appropriate to
your community <code>data_type</code> (binary, quantitative, abundance). This argument is ignored if <code>fun</code> is
<code>"tip_shuffle"</code> or if it is a custom function.</p></dd>


<dt id="arg-n-rand">n_rand<a class="anchor" aria-label="anchor" href="#arg-n-rand"></a></dt>
<dd><p>Integer giving the number of random communities to generate.</p></dd>


<dt id="arg-summary">summary<a class="anchor" aria-label="anchor" href="#arg-summary"></a></dt>
<dd><p>Character indicating which summary statistic to return. If <code>"quantile"</code>, the default, the function
returns the proportion of randomizations in which the observed diversity metric was greater than the randomized
metric. If <code>"zscore"</code>, it returns a "standardized effect size" or z-score relating the observed value to the mean and
standard deviation of the randomizations.</p></dd>


<dt id="arg-spatial">spatial<a class="anchor" aria-label="anchor" href="#arg-spatial"></a></dt>
<dd><p>Logical: should the function return a spatial object (TRUE, default) or a matrix (FALSE).</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer giving the number of compute cores to use for parallel processing.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical: should a progress bar be displayed?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <a href="quantize.html">quantize</a>, <a href="https://rdrr.io/pkg/vegan/man/nullmodel.html" class="external-link">simulate.nullmodel</a>, or custom function
<code>fun</code>. Note that the <code>nsim</code> argument the former two functions should not be used here; specify <code>n_rand</code> instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix with a row for every row of <code>x</code>, a column for every metric specified in <code>metric</code>, and
values for the <code>summary</code> statistic. Or if <code>spatial = TRUE</code>, a <code>sf</code> or <code>SpatRaster</code> object containing these data.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ps_diversity.html">ps_diversity()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># simulate a `phylospatial` data set and run randomization with default settings</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="ps_simulate.html">ps_simulate</a></span><span class="op">(</span>data_type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rand</span> <span class="op">&lt;-</span> <span class="fu">ps_rand</span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using the default `quantize` function, but with alternative arguments</span></span></span>
<span class="r-in"><span><span class="va">rand</span> <span class="op">&lt;-</span> <span class="fu">ps_rand</span><span class="op">(</span><span class="va">ps</span>, transform <span class="op">=</span> <span class="va">sqrt</span>, n_strata <span class="op">=</span> <span class="fl">4</span>, priority <span class="op">=</span> <span class="st">"rows"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using binary data</span></span></span>
<span class="r-in"><span><span class="va">ps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="ps_simulate.html">ps_simulate</a></span><span class="op">(</span>data_type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rand</span> <span class="op">&lt;-</span> <span class="fu">ps_rand</span><span class="op">(</span><span class="va">ps2</span>, fun <span class="op">=</span> <span class="st">"nullmodel"</span>, method <span class="op">=</span> <span class="st">"r2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using abundance data, and demonstrating alternative metric choices</span></span></span>
<span class="r-in"><span><span class="va">ps3</span> <span class="op">&lt;-</span> <span class="fu"><a href="ps_simulate.html">ps_simulate</a></span><span class="op">(</span>data_type <span class="op">=</span> <span class="st">"abund"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rand</span> <span class="op">&lt;-</span> <span class="fu">ps_rand</span><span class="op">(</span><span class="va">ps3</span>, metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ShPD"</span>, <span class="st">"SiPD"</span><span class="op">)</span>, fun <span class="op">=</span> <span class="st">"nullmodel"</span>, method <span class="op">=</span> <span class="st">"abuswap_c"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rand</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatRaster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimensions  : 20, 20, 2  (nrow, ncol, nlyr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> resolution  : 1, 1  (x, y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : 0, 20, 0, 20  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coord. ref. :  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source(s)   : memory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varnames    : qShPD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               qSiPD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names       : qShPD, qSiPD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min values  :  0.00,  0.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max values  :  0.03,  0.03 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Kling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

